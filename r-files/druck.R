druck <- function(T){
  Tc=1764
  pc=167000000
  a1=-4.57618368
  a2=-1.40726277
  a3=2.36263541
  a4=-31.0889985
  a5=58.0183959
  a6=-27.6304546
  
  Tr=(1-T/Tc)
  
  return(pc*exp(Tc/T*(a1*Tr+a2*Tr^(1.89)+a3*Tr^2+a4*Tr^8+a5*Tr^(8.5)+a6*Tr^9)))
}

sdruck <- function(p,T,sT){
  sig = matrix(c( 0.002223462, -0.039761786,  0.038596482, -0.057150539,  0.104904983, -0.048841224,
                      -0.039761786,  0.713627443, -0.693021642,  1.050624836, -1.931983155,  0.901047084,
                      0.038596482, -0.693021642,  0.673047757, -1.023299883,  1.882148471, -0.877990861,
                      -0.057150539,  1.050624836, -1.023299883,  1.805980893, -3.35831368,   1.583127006,
                      0.104904983, -1.931983155,  1.882148471, -3.35831368,   6.249787823, -2.948350916,
                      -0.048841224,  0.901047084, -0.877990861,  1.583127006, -2.948350916,  1.391862893),
                   nrow=6, ncol=6, 
                   byrow=TRUE
    )
  
  Tc=1764
  pc=167000000
  a=c()
  a[1]=-4.57618368
  a[2]=-1.40726277
  a[3]=2.36263541
  a[4]=-31.0889985
  a[5]=58.0183959
  a[6]=-27.6304546
  
  x=c(1,1.89,2,8,8.5,9)
  
  Tr=(1-T/Tc)
  
  dpdT=-1/Tc*p/(1-Tr)*sum((a*Tr^x)*(-1/(1-Tr)+x/Tr))
  dpda=p/(1-Tr)*Tr^x
  dpda1=dpda[1]*dpda*sig[1,]
  dpda2=dpda[2]*dpda*sig[2,]
  dpda3=dpda[3]*dpda*sig[3,]
  dpda4=dpda[4]*dpda*sig[4,]
  dpda5=dpda[5]*dpda*sig[5,]
  dpda6=dpda[6]*dpda*sig[6,]
  
  
  sp=sqrt(dpdT^2*sT^2+dpda1+dpda2+dpda3+dpda4+dpda5+dpda6)
  
  return(sp)
}